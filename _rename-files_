!#/bin/bash

# switch to the directory the script is at
dir=$(dirname "$0")
cd "$dir" || exit 1

# remove _ prefix from nuxt build dir
mv _nuxt/ nuxt
find . -type f | xargs grep '/_nuxt' --files-with-matches | xargs sed 's;/_nuxt;/nuxt;g' -i

# remove _ prefix from JSON payload files
find . -type f -name '_payload.json' | while read f; do
  dir=$(dirname "$f")
  mv "$f" "${dir}/payload.json"
done
find . -type f | xargs grep 'payload.json' --files-with-matches | xargs sed 's;_payload.json;payload.json;g' -i
